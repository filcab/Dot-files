#!/usr/bin/env python

from __future__ import print_function

import distutils.spawn
import subprocess
import sys

# Hack for WSL:
if sys.platform == 'linux2':
  helper = ['/mnt/c/Program Files/Git/mingw64/libexec/git-core/git-credential-wincred.exe']
  if file(helper[0]):
    False and print('helper: executing: {}'.format(helper+sys.argv[1:]), file=sys.stderr)
    sys.exit(subprocess.call(helper + sys.argv[1:]))

d = {'darwin': 'osxkeychain', 'linux2': 'cache', 'win32': 'wincred'}
helper_name = d[sys.platform]

if helper_name == 'cache':
  helper = ['git', 'credential-cache']
else:
  helper_name = 'git-credential-{}'.format(helper_name)
  helper = [distutils.spawn.find_executable(helper_name)]

False and print('helper: executing: {}'.format(helper+sys.argv[1:]), file=sys.stderr)
sys.exit(subprocess.call(helper + sys.argv[1:]))
